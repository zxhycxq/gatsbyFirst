{"data":{"content":{"edges":[{"node":{"id":"dbfd2869-f85c-5a82-ba1d-8d0ae5c21ec0","html":"<h2 id=\"前言\"><a href=\"#%E5%89%8D%E8%A8%80\" aria-label=\"前言 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>前言</h2>\n<p>在程序員的日常精進之中，閱讀優秀的代碼是必不可少的。透過 TDD 的開發模式，可以模仿那些優秀的代碼，從而提升自己代碼水平。下面介紹如何從零開始搭建 TDD 環境，並構建 isEven 代碼。</p>\n<p><img src=\"https://i.imgur.com/N45ca8A.jpg\" alt=\"Imgur\"></p>\n<p>Test Driven Development (TDD)，指的是先寫最小部分的測試代碼，然後寫開發業務代碼，通過測試。然後重構，並不更改測試用例的表現方式。</p>\n<h3 id=\"好處\"><a href=\"#%E5%A5%BD%E8%99%95\" aria-label=\"好處 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>好處</h3>\n<ol>\n<li>節省重複手動測試代碼是否正常的時間</li>\n<li>輕鬆寫測試代碼</li>\n<li>通過測試用例就可以輕鬆喝茶</li>\n</ol>\n<h2 id=\"已實現工具\"><a href=\"#%E5%B7%B2%E5%AF%A6%E7%8F%BE%E5%B7%A5%E5%85%B7\" aria-label=\"已實現工具 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>已實現工具</h2>\n<p>在過去的一段時間里，我閱讀了一些下載量大，並以 TDD 開發模式實現的一些工具庫。比如說：</p>\n<ol>\n<li><a href=\"#iseven-%E4%BB%A3%E7%A2%BC%E8%A7%A3%E8%AE%80\">isEven</a></li>\n<li>isObject</li>\n<li>isNumber</li>\n<li>isEmptyObject</li>\n<li>extend</li>\n<li>underscore/keys</li>\n</ol>\n<h2 id=\"如何開始？\"><a href=\"#%E5%A6%82%E4%BD%95%E9%96%8B%E5%A7%8B%EF%BC%9F\" aria-label=\"如何開始？ permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>如何開始？</h2>\n<p>學習 TDD，我們首先需要搭建一個可以提供單元測試環境，比如利用 ava 測試工具。</p>\n<h3 id=\"搭建單元測試環境-sop\"><a href=\"#%E6%90%AD%E5%BB%BA%E5%96%AE%E5%85%83%E6%B8%AC%E8%A9%A6%E7%92%B0%E5%A2%83-sop\" aria-label=\"搭建單元測試環境 sop permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>搭建單元測試環境 SOP</h3>\n<ol>\n<li>構建新項目：<code class=\"language-text\">mkdir tdd-playround</code></li>\n<li>進入項目：<code class=\"language-text\">cd tdd-playgound</code></li>\n<li>在項目裡面構建 <code class=\"language-text\">src</code> 及 <code class=\"language-text\">test</code> 文件夾：<code class=\"language-text\">mkdir src</code>，<code class=\"language-text\">mkdir test</code></li>\n<li><code class=\"language-text\">npm init -y</code> 來構建 npm 包</li>\n<li>運行命令 <code class=\"language-text\">npx create-ava --next</code></li>\n<li>然後運行 npm-scripts：<code class=\"language-text\">npm run test -- --watch</code></li>\n</ol>\n<p><img src=\"https://i.imgur.com/JgLks0d.jpg\" alt=\"Imgur\"></p>\n<h2 id=\"使用搭建好的環境\"><a href=\"#%E4%BD%BF%E7%94%A8%E6%90%AD%E5%BB%BA%E5%A5%BD%E7%9A%84%E7%92%B0%E5%A2%83\" aria-label=\"使用搭建好的環境 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>使用搭建好的環境</h2>\n<p>與其搭建一個 TDD 環境，不如用已經搭建好的環境。</p>\n<p><a href=\"https://github.com/calpa/tdd-playground\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">tdd-playground</a> 自帶測試代碼以及環境。</p>\n<h3 id=\"使用方法\"><a href=\"#%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95\" aria-label=\"使用方法 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>使用方法</h3>\n<p>只需要 Clone 下來，然后安裝就行了。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">```\ngit clone https://github.com/calpa/tdd-playground.git\ncd tdd-playground\nnpm install\nnpm run test\n```</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id=\"如何使用這個工程？\"><a href=\"#%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E9%80%99%E5%80%8B%E5%B7%A5%E7%A8%8B%EF%BC%9F\" aria-label=\"如何使用這個工程？ permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>如何使用這個工程？</h3>\n<ol>\n<li>\n<p>你可以移走整個 <code class=\"language-text\">src</code> 文件夾，然後重新編寫你的 js 文件。</p>\n</li>\n<li>\n<p>你可以移走部分的<code class=\"language-text\">src/*.js</code> 文件，然後重新編寫該部分文件。</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell line-numbers\"><code class=\"language-shell\"><span class=\"token function\">git</span> <span class=\"token function\">mv</span> ./src ./answer\n<span class=\"token function\">npm</span> run <span class=\"token function\">test</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n</li>\n</ol>\n<p>值得注意的是，使用 <code class=\"language-text\">git mv</code> 而不是 <code class=\"language-text\">mv</code> 命令的話，可以避免 git log 混亂的問題。</p>\n<h2 id=\"tdd-的-sop\"><a href=\"#tdd-%E7%9A%84-sop\" aria-label=\"tdd 的 sop permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>TDD 的 SOP</h2>\n<p>這裡介紹一個最簡單的工具：isEven（測試是否雙數）</p>\n<p>這裡 isEven 可以取代為任意有效 JS 名稱：</p>\n<ol>\n<li>\n<p>首先執行 <code class=\"language-text\">npm run test -- --watch</code> 自動監控代碼變化</p>\n</li>\n<li>\n<p>構建測試代碼，以 <code class=\"language-text\">isEven.test.js</code>為 Javascript 測試代碼的名稱</p>\n</li>\n<li>\n<p>在<code class=\"language-text\">test/isEven.test.js</code> 寫下以下代碼：</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> test <span class=\"token keyword\">from</span> <span class=\"token string\">'ava'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> isEven <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'../src/isEven'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">test</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"isEven should be a function\"</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">t</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n   t<span class=\"token punctuation\">.</span><span class=\"token function\">deepEqual</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> isEven<span class=\"token punctuation\">,</span> <span class=\"token string\">\"function\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"isEven is not a function\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n</li>\n<li>\n<p>測試代碼此時有報錯信息，原因是我們現在沒有寫<code class=\"language-text\">/src/isEven.js</code></p>\n</li>\n<li>\n<p>在<code class=\"language-text\">/src/isEven.js</code>裡面寫下基本函數：</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">isEven</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> isEven<span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>值得注意的是，由於我們在低版本的 Node.js 環境下，無法使用 import/export 語法。</p>\n</li>\n<li>\n<p>（再次運行 <code class=\"language-text\">npm run test</code>），這個時候你就可以看到已經通過測試了。</p>\n</li>\n</ol>\n<h2 id=\"iseven-代碼解讀\"><a href=\"#iseven-%E4%BB%A3%E7%A2%BC%E8%A7%A3%E8%AE%80\" aria-label=\"iseven 代碼解讀 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>isEven 代碼解讀</h2>\n<ol>\n<li>\n<p>我們要引入測試工具，以及代碼片段：</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> test <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ava\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> isEven <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"../src/isEven\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n</li>\n<li>\n<p>我們要寫一個確認該函數是否存在的測試用例：</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token function\">test</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"isEven should be a function\"</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">t</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\nt<span class=\"token punctuation\">.</span><span class=\"token function\">deepEqual</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> isEven<span class=\"token punctuation\">,</span> <span class=\"token string\">\"function\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"isEven is not a function\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n</li>\n<li>\n<p>先寫一些正常的測試用例：</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token function\">test</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"should be true\"</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">t</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n t<span class=\"token punctuation\">.</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">(</span><span class=\"token function\">isEven</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n t<span class=\"token punctuation\">.</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">(</span><span class=\"token function\">isEven</span><span class=\"token punctuation\">(</span><span class=\"token number\">42</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n t<span class=\"token punctuation\">.</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">(</span><span class=\"token function\">isEven</span><span class=\"token punctuation\">(</span><span class=\"token number\">999994</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n t<span class=\"token punctuation\">.</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">(</span><span class=\"token function\">isEven</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n t<span class=\"token punctuation\">.</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">(</span><span class=\"token function\">isEven</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n</li>\n<li>\n<p>此時，<code class=\"language-text\">/src/isEven.js</code> 應該有正常的代碼：</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">isEven</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">item</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n<span class=\"token keyword\">return</span> <span class=\"token operator\">!</span><span class=\"token punctuation\">(</span>item <span class=\"token operator\">%</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>結果是返回 x mod 2 === 0，很簡單。</p>\n</li>\n<li>\n<p>然後，再測試單數。</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token function\">test</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"should be false\"</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">t</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n t<span class=\"token punctuation\">.</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">(</span><span class=\"token function\">isEven</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n t<span class=\"token punctuation\">.</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">(</span><span class=\"token function\">isEven</span><span class=\"token punctuation\">(</span><span class=\"token number\">9</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n t<span class=\"token punctuation\">.</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">(</span><span class=\"token function\">isEven</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n t<span class=\"token punctuation\">.</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">(</span><span class=\"token function\">isEven</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n</li>\n<li>\n<p>再加極端值：</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token function\">test</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"should not take infinite number\"</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">t</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n t<span class=\"token punctuation\">.</span><span class=\"token function\">deepEqual</span><span class=\"token punctuation\">(</span><span class=\"token function\">isEven</span><span class=\"token punctuation\">(</span><span class=\"token number\">Infinity</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"expect finite number\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">test</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"should not take non integer\"</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">t</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n t<span class=\"token punctuation\">.</span><span class=\"token function\">deepEqual</span><span class=\"token punctuation\">(</span><span class=\"token function\">isEven</span><span class=\"token punctuation\">(</span><span class=\"token number\">0.1234</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"expect integer\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">test</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"should not take unsafe integer\"</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">t</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n t<span class=\"token punctuation\">.</span><span class=\"token function\">deepEqual</span><span class=\"token punctuation\">(</span><span class=\"token function\">isEven</span><span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">pow</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">53</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"expect safe integer\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n</li>\n<li>\n<p>再運行 <code class=\"language-text\">npm run test</code>。\n這個時候，我們就跑不過測試用例了。</p>\n</li>\n<li>\n<p>我們要把 isEven 改成只讀安全的整數：</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">isEven</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">item</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>Number<span class=\"token punctuation\">.</span><span class=\"token function\">isFinite</span><span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token string\">\"expect finite number\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>Number<span class=\"token punctuation\">.</span><span class=\"token function\">isInteger</span><span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token string\">\"expect integer\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>Number<span class=\"token punctuation\">.</span><span class=\"token function\">isSafeInteger</span><span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token string\">\"expect safe integer\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">return</span> <span class=\"token operator\">!</span><span class=\"token punctuation\">(</span>item <span class=\"token operator\">%</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n</li>\n<li>\n<p>再次運行 <code class=\"language-text\">npm run test</code>\n這個時候，就可以綠燈全開。</p>\n</li>\n<li>\n<p>然後，你就可以愉快地重構，實現方式可以不同，但必須通過測試用例。</p>\n</li>\n</ol>\n<h2 id=\"todo\"><a href=\"#todo\" aria-label=\"todo permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>TODO</h2>\n<ol>\n<li>isURL</li>\n<li>判斷各種 JavaScript 基本類型的工具</li>\n<li>underscore</li>\n<li>moment/dayjs</li>\n<li>isPromise</li>\n</ol>\n<h2 id=\"後記\"><a href=\"#%E5%BE%8C%E8%A8%98\" aria-label=\"後記 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>後記</h2>\n<p>如果你有興趣學習 TDD 的話，你可以到我的 <a href=\"https://github.com/calpa/tdd-playground\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">tdd-playground</a> 下 fork + star。</p>","tableOfContents":"<ul>\n<li>\n<p><a href=\"/2018/11/02/learn-javascript-npm-via-testing-driven-development/#%E5%89%8D%E8%A8%80\">前言</a></p>\n<ul>\n<li><a href=\"/2018/11/02/learn-javascript-npm-via-testing-driven-development/#%E5%A5%BD%E8%99%95\">好處</a></li>\n</ul>\n</li>\n<li><a href=\"/2018/11/02/learn-javascript-npm-via-testing-driven-development/#%E5%B7%B2%E5%AF%A6%E7%8F%BE%E5%B7%A5%E5%85%B7\">已實現工具</a></li>\n<li>\n<p><a href=\"/2018/11/02/learn-javascript-npm-via-testing-driven-development/#%E5%A6%82%E4%BD%95%E9%96%8B%E5%A7%8B%EF%BC%9F\">如何開始？</a></p>\n<ul>\n<li><a href=\"/2018/11/02/learn-javascript-npm-via-testing-driven-development/#%E6%90%AD%E5%BB%BA%E5%96%AE%E5%85%83%E6%B8%AC%E8%A9%A6%E7%92%B0%E5%A2%83-sop\">搭建單元測試環境 SOP</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"/2018/11/02/learn-javascript-npm-via-testing-driven-development/#%E4%BD%BF%E7%94%A8%E6%90%AD%E5%BB%BA%E5%A5%BD%E7%9A%84%E7%92%B0%E5%A2%83\">使用搭建好的環境</a></p>\n<ul>\n<li><a href=\"/2018/11/02/learn-javascript-npm-via-testing-driven-development/#%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95\">使用方法</a></li>\n<li><a href=\"/2018/11/02/learn-javascript-npm-via-testing-driven-development/#%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E9%80%99%E5%80%8B%E5%B7%A5%E7%A8%8B%EF%BC%9F\">如何使用這個工程？</a></li>\n</ul>\n</li>\n<li><a href=\"/2018/11/02/learn-javascript-npm-via-testing-driven-development/#tdd-%E7%9A%84-sop\">TDD 的 SOP</a></li>\n<li><a href=\"/2018/11/02/learn-javascript-npm-via-testing-driven-development/#iseven-%E4%BB%A3%E7%A2%BC%E8%A7%A3%E8%AE%80\">isEven 代碼解讀</a></li>\n<li><a href=\"/2018/11/02/learn-javascript-npm-via-testing-driven-development/#todo\">TODO</a></li>\n<li><a href=\"/2018/11/02/learn-javascript-npm-via-testing-driven-development/#%E5%BE%8C%E8%A8%98\">後記</a></li>\n</ul>","excerpt":"前言在程序員的日常精進之中，閱讀優秀的代碼是必不可少的。透過 TDD 的開發模式，可以模仿那些優秀的代碼，從而提升自己代碼水平。下面介紹如何從零開始搭建 TDD 環境，並構建 isEven 代碼。ImgurTest Driven Development (TDD…","fields":{"slug":"/2018/11/02/learn-javascript-npm-via-testing-driven-development/"},"frontmatter":{"id":"20181102a","title":"透過 TDD 模式學習如何實現各種 npm 工具","slug":"/2018/11/02/learn-javascript-npm-via-testing-driven-development/","date":"2018-11-02T03:48:03.125Z","headerImage":null}},"previous":null,"next":null}]}},"pageContext":{"isCreatedByStatefulCreatePages":false,"id":"dbfd2869-f85c-5a82-ba1d-8d0ae5c21ec0","index":12}}